<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Multicast.">

    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

    <title>Multicast - Contiv</title>

    <link href="/assets/stylesheets/application-045481d8.css" rel="stylesheet"/>

    <!--[if lt IE 9]><script src="/assets/javascripts/html5shiv-8b3747c5.js"></script><script src="/assets/javascripts/respond.min-88c91176.js"></script><![endif]-->

    
  </head>

  <body id="page-Multicast" class=" page-Multicast layout-install page-sub">

<div id="header" class="navbar-static-top">
  <div class="container">
    <div class="row">
      <div class="col-xs-12">
        <div class="navbar-header">
          <div class="navbar-brand">
            <a class="logo" href="/">Contiv</a>
          </div>
          <button class="navbar-toggle" type="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="buttons hidden-xs">
          <nav role="navigation">
            <ul class="external-links nav navbar-nav navbar-right">
              <li class="github">
                <a href="https://github.com/contiv"><svg id="svg-download" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" style="enable-background:new 0 0 14 14;">
  <style>
  </style>
  <path class="" d="M13,0H1C0.5,0,0,0.5,0,1v12c0,0.5,0.5,1,1,1h4.7c0,0,0,0,0-0.1c0-0.2,0-0.6,0-1.1c-1.8,0.4-2.2-0.9-2.2-0.9
    c-0.3-0.8-0.7-1-0.7-1c-0.6-0.4,0-0.4,0-0.4c0.7,0,1,0.7,1,0.7c0.6,1,1.5,0.7,1.9,0.5c0.1-0.4,0.2-0.7,0.4-0.9c-1.5-0.2-3-0.7-3-3.2
    c0-0.7,0.3-1.3,0.7-1.8C3.7,5.8,3.5,5.1,3.9,4.2c0,0,0.6-0.2,1.8,0.7c0.5-0.1,1.1-0.2,1.6-0.2c0.6,0,1.1,0.1,1.6,0.2
    c1.3-0.8,1.8-0.7,1.8-0.7c0.4,0.9,0.1,1.6,0.1,1.7c0.4,0.5,0.7,1,0.7,1.8c0,2.5-1.5,3.1-3,3.2C8.7,11.1,9,11.5,9,12.1
    c0,0.9,0,1.6,0,1.8c0,0,0,0,0,0.1h4c0.5,0,1-0.5,1-1V1C14,0.5,13.5,0,13,0z"/>
</svg>
GitHub</a>
              </li>
            </ul>
            <ul class="main-links nav navbar-nav navbar-right">
              <li class="first li-under"><a href="/install/index.html">Getting Started</a></li>
              <li class="li-under"><a href="/docs/index.html">Docs</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="sidebar-overlay"></div>


<aside id="sidebar" class="sidebar sidebar-default sidebar-fixed-right" role="navigation">
    
    <div class="sidebar-header header-cover">
        
        <div class="sidebar-image">
            <img src="/assets/images/logo-header@2x.png" width="49px" height="56px">
        </div>
    </div>

    
    <ul class="main nav sidebar-nav">
        <li class="first"><a href="/intro/index.html">Intro</a></li>
        <li class=""><a href="/docs/index.html">Docs</a></li>
    </ul>
    <div class="divider"></div>
    
    <ul class="external nav sidebar-nav">
        <li class=""><a class="v-btn gray sml" href="https://github.com/contiv"><svg id="svg-download" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" style="enable-background:new 0 0 14 14;">
  <style>
  </style>
  <path class="" d="M13,0H1C0.5,0,0,0.5,0,1v12c0,0.5,0.5,1,1,1h4.7c0,0,0,0,0-0.1c0-0.2,0-0.6,0-1.1c-1.8,0.4-2.2-0.9-2.2-0.9
    c-0.3-0.8-0.7-1-0.7-1c-0.6-0.4,0-0.4,0-0.4c0.7,0,1,0.7,1,0.7c0.6,1,1.5,0.7,1.9,0.5c0.1-0.4,0.2-0.7,0.4-0.9c-1.5-0.2-3-0.7-3-3.2
    c0-0.7,0.3-1.3,0.7-1.8C3.7,5.8,3.5,5.1,3.9,4.2c0,0,0.6-0.2,1.8,0.7c0.5-0.1,1.1-0.2,1.6-0.2c0.6,0,1.1,0.1,1.6,0.2
    c1.3-0.8,1.8-0.7,1.8-0.7c0.4,0.9,0.1,1.6,0.1,1.7c0.4,0.5,0.7,1,0.7,1.8c0,2.5-1.5,3.1-3,3.2C8.7,11.1,9,11.5,9,12.1
    c0,0.9,0,1.6,0,1.8c0,0,0,0,0,0.1h4c0.5,0,1-0.5,1-1V1C14,0.5,13.5,0,13,0z"/>
</svg>
GitHub</a></li>
    </ul>
</aside>


<div class="container">
	<div class="row">
		<div class="col-md-3 col-sm-3 col-xs-12">
					<div class="docs-sidebar hidden-print affix-top" role="complementary">
			<ul class="nav docs-sidenav">
				<li>
					<a href="/install/index.html">Getting Started</a>
				</li>

				<li class="active">
					<a href="/install/netplugin/vagrant.html">Netplugin</a>
					<ul class="nav">
						<li>
							<a href="/install/netplugin/install.html">Installing Netplugin</a>
						</li>
						<li>
							<a href="/install/netplugin/aci.html">ACI setup</a>
						</li>
						<li>
							<a href="/install/netplugin/k8s.html">Kubernetes cluster</a>
						</li>
						<li>
							<a href="/install/netplugin/bgp.html">BGP L3 setup</a>
                        </li>

						<li class="active">
							<a href="/install/netplugin/mcast.html">Multicast</a>
						</li>
					</ul>
				</li>
			</ul>
		</div>

		</div>  
		<div id="main-content" class="col-sm-9 col-md-8 col-xs-12" role="main">
			<div class="bs-docs-section">
				
	<h2>Multicast application demo</h2>
<p>The purpose of the document is to illustrate the experiment done to validate
multicast in a contiv network.</p>

<h3>Steps to run sender and receiver multicast application between containers</h3>
<p>For this experiement we will run 2 containers , one on each VM. We will create a vlan network
and run a sender and receiver multicast application. For the purpose of this demo we will be using
multicast application from <a href="https://github.com/leslie-wang/py-multicast-example">https://github.com/leslie-wang/py-multicast-example</a></p>

<h4>Step 1: Pull the contiv netplugin workspace from github</h4>
<pre class="highlight plaintext"><code>$ git clone https://github.com/contiv/netplugin
$ cd netplugin
</code></pre>

<h4>Step 2: Create demo VMs</h4>

<ul>
<li>Start vms
</li>
<li>Create multicast enabled network
</li>
</ul>
<pre class="highlight plaintext"><code>$ make demo
$ vagrant ssh netplugin-node1
$ sudo netctl net create contiv-net --encap=vlan --subnet=20.1.1.0/24 --gateway=20.1.1.254 --pkt-tag=1010
</code></pre>

<h4>Step 3: Run a docker container in the network created and start multicast sender application.</h4>
<pre class="highlight plaintext"><code>$ docker pull qiwang/centos7-mcast
$ docker run -it --name=msender --net=contiv-net qiwang/centos7-mcast /bin/bash
root@9f4e7fd418c5:/# cd /root
root@9f4e7fd418c5:/# ./mcast.py -s -i eth0
</code></pre>

<h4>Step 4: Login to netplugin-node2</h4>
<p><code>vagrant ssh netplugin-node2</code></p>

<h4>Step 5: Run a docker container in the network created and launch the multicast receiver</h4>
<pre class="highlight plaintext"><code>$ docker pull qiwang/centos7-mcast
$ docker run -it --name=mreceiver --net=contiv-net qiwang/centos7-mcast /bin/bash
root@564f7f4424c1:/# cd /root
root@564f7f4424c1:/# ./mcast.py -i eth0

('20.1.1.3', 35624)  '1453881422.973572'
('20.1.1.3', 35624)  '1453881423.977554'
('20.1.1.3', 35624)  '1453881424.978941'
</code></pre>
<p>where 20.1.1.3 is the IP assigned to container msender.</p>

<h3>Steps to run sender and receiver multicast application between container and host VM</h3>

<h4>Step 1: Create demo VMs</h4>

<ul>
<li>Start vms
</li>
<li>Create multicast enabled network
</li>
</ul>
<pre class="highlight plaintext"><code>$ make demo
$ vagrant ssh netplugin-node1
$ sudo netctl net create contiv-net --encap=vlan --subnet=20.1.1.0/24 --gateway=20.1.1.254 --pkt-tag=1010
</code></pre>

<h4>Step 2: Create a port on the OVS with the network tag used for contiv-net</h4>
<pre class="highlight plaintext"><code>$ sudo ovs-vsctl add-port contivVlanBridge port1 -- set interface inb01 type=internal
$ sudo ovs-vsctl set port port1 tag=1010
$ ifconfig port1 30.1.1.8/24
</code></pre>

<h4>Step 3: Launch a multicast sender application</h4>
<p><code>$ ./mcast.py -s -i inb01</code></p>

<h4>Step 4: Login to netplugin-node2</h4>
<p><code>$ vagrant ssh netplugin-node2</code></p>

<h4>Step 5: Run a docker container in the network created and launch multicast receiver.</h4>
<pre class="highlight plaintext"><code>$ docker pull qiwang/centos7-mcast
$ docker run -it --name=mreceiver --net=contiv-net qiwang/centos7-mcast /bin/bash
root@426b8cdbf5f8:/# cd /root
root@426b8cdbf5f8:/# ./mcast.py -i eth0

('30.1.1.8', 35678)  '1453882966.102203'
('30.1.1.8', 35678)  '1453882967.120764'
('30.1.1.8', 35678)  '1453882968.12215'
</code></pre>


			</div>
		</div>
	</div>
</div>


<div id="footer">
  <div class="container">
    <div class="row">
        <div class="edit-page-link"><a href="https://github.com/contiv/netplugin/blob/master/website/source/install/netplugin/mcast.md">Edit this page</a></div>
      <div class="col-sm-6 col-xs-12">
        <ul class="footer-links nav navbar-nav">
          <li><a href="/intro/index.html">Getting Started</a></li>
          <li><a href="/docs/index.html">Docs</a></li>
        </ul>
      </div>
      <div class="footer-contiv col-sm-6 col-xs-12">
        <div class="pull-right">
          <a class="contiv-project" href="https://contiv.io">
              Contiv
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

</body>
</html>